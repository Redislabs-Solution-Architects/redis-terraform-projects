#==============================================================================
# REDIS ENTERPRISE SOFTWARE AWS - REQUIRED CONFIGURATION
# Copy this file to terraform.tfvars and update these values before deployment
#==============================================================================

#==============================================================================
# ‚ö†Ô∏è  REQUIRED VALUES - MUST BE CHANGED BEFORE DEPLOYMENT
#==============================================================================

# Project identification (REQUIRED)
user_prefix  = "your-name"        # CHANGE: Your unique identifier (your name, team, etc.)
cluster_name = "redis-ent"        # Redis Enterprise cluster name
owner        = "your-name"        # CHANGE: Your name/team

# AWS Configuration (REQUIRED)
aws_region            = "us-west-2"                      # CHANGE: Your preferred AWS region
key_name              = "your-ec2-key-name"              # CHANGE: Your EC2 key pair name
ssh_private_key_path  = "path/to/your/private-key.pem"   # CHANGE: Path to your SSH private key

# Availability Zones (OPTIONAL)
availability_zones = []  # Leave empty for automatic multi-AZ selection
# availability_zones = ["us-west-2a", "us-west-2b", "us-west-2c"]  # Specific AZs (multi-AZ)
# availability_zones = ["us-west-2a"]                              # Single AZ deployment

# Load Balancer Configuration (REQUIRED)
load_balancer_type = "nlb"                                     # CHANGE: Choose "nlb" (AWS managed), "haproxy" (self-managed), or "nginx" (self-managed with stream module)

# Redis Enterprise Software (REQUIRED)
# Visit: https://redis.io/docs/latest/operate/rs/installing-upgrading/install/plan-deployment/supported-platforms/
# Find the latest download URL for your platform and paste it below
re_download_url = "REPLACE_WITH_YOUR_REDIS_ENTERPRISE_DOWNLOAD_URL"

# Cluster Credentials (Use alphanumeric passwords only!)
cluster_username = "admin@admin.com"        # Your admin email
cluster_password = "admin"  # password (alphanumeric only - no special characters)

# Security (RECOMMENDED)
# For testing only: use ["0.0.0.0/0"] for open access
allow_ssh_from = ["YOUR.PUBLIC.IP.ADDRESS/32"]  # CHANGE: Your public IP for SSH access

#==============================================================================
# CLUSTER CONFIGURATION (Optional - Good defaults provided)
#==============================================================================

# Basic Settings
project = "redis-enterprise-software-aws-lb"

# Cluster Size and Performance
node_count     = 3               # Number of Redis nodes (minimum 3)
instance_type  = "t3.xlarge"     # EC2 instance type (16GB RAM - good for testing)
node_root_size = 50              # Root disk size in GB

# Platform Selection
platform = "ubuntu"              # Choose: "ubuntu" or "rhel"

# High Availability
rack_awareness = true             # Enable rack/zone awareness for HA
flash_enabled  = false           # Enable Redis on Flash (RoF) - optional
use_elastic_ips = false          # Enable Elastic IPs for persistent public addresses

#==============================================================================
# NETWORK CONFIGURATION (Optional - Good defaults provided)
#==============================================================================

# VPC and Subnets (will be created for you)
vpc_cidr             = "10.0.0.0/16"
public_subnet_cidrs  = ["10.0.1.0/24", "10.0.2.0/24", "10.0.3.0/24"]
private_subnet_cidrs = ["10.0.4.0/24", "10.0.5.0/24", "10.0.6.0/24"]

#==============================================================================
# STORAGE CONFIGURATION (Optional - Good defaults provided)
#==============================================================================

# EBS Storage (based on RAM requirements)
data_volume_size       = 64      # Data volume size in GB (RAM x 4)
data_volume_type       = "gp3"   # EBS volume type for data storage
persistent_volume_size = 64      # Persistent volume size in GB (RAM x 4)
persistent_volume_type = "gp3"   # EBS volume type for persistent storage
ebs_encryption_enabled = true    # Enable EBS encryption

#==============================================================================
# SAMPLE DATABASE CONFIGURATION (Optional - Good defaults provided)
#==============================================================================

# Automatic Database Creation
create_sample_database = true    # Create a demo database for testing
sample_db_name        = "demo"   # Database name
sample_db_port        = 12000    # Database port (10000-19999)
sample_db_memory      = 100      # Memory size in MB

#==============================================================================
# RESOURCE TAGGING (Optional - Customize as needed)
#==============================================================================

tags = {
  environment = "demo"
  purpose     = "redis-enterprise-testing"
}

#==============================================================================
# NGINX LOAD BALANCER CONFIGURATION (Optional - Good defaults provided)
#==============================================================================

# NGINX Instance Configuration (only used when load_balancer_type = "nginx")
nginx_instance_type       = "t3.medium"    # EC2 instance type for NGINX load balancers
nginx_instance_count      = 2              # Number of NGINX instances for HA

# API and UI Port Mapping (frontend = client-facing, backend = Redis Enterprise internal)
frontend_api_port         = 9443           # Redis Enterprise API port (HTTPS)
backend_api_port          = 9443           # Redis Enterprise API internal port
frontend_ui_port          = 443            # Redis Enterprise UI port (HTTPS)
backend_ui_port           = 8443           # Redis Enterprise UI internal port

# Load Balancing Methods
api_lb_method             = "round_robin"  # API LB: round_robin is good for stateless calls
ui_lb_method              = "ip_hash"      # UI LB: ip_hash for session affinity

# Health Check Configuration
max_fails                 = 3              # Max failures before marking server down
fail_timeout              = "30s"          # Time server marked down after max_fails
proxy_timeout             = "1s"           # Connection timeout to backend

# Database Port Range Configuration
# This automatically opens and configures load balancing for a range of Redis Enterprise database ports
# All databases (including the sample database) should be within this range
database_port_range_start = 12000    # Start of port range (inclusive) - includes sample DB port
database_port_range_end   = 12010    # End of port range (inclusive)

# Alternative: Individual database ports (commented out - use port range above instead)
# additional_database_ports = [
#   {
#     name          = "cache-db"
#     frontend_port = 6380
#     backend_port  = 12001
#   },
#   {
#     name          = "session-db"
#     frontend_port = 6381
#     backend_port  = 12002
#   }
# ]

#==============================================================================
# HAPROXY LOAD BALANCER CONFIGURATION (Optional - Good defaults provided)
#==============================================================================

# HAProxy Instance Configuration (only used when load_balancer_type = "haproxy")
haproxy_instance_type = "t3.medium"    # EC2 instance type for HAProxy load balancers

#==============================================================================
# üîó HELPFUL INFORMATION
#==============================================================================
#
# After deployment, your cluster will be accessible via the load balancer:
# ‚Ä¢ NLB:     Access via NLB DNS name (shown in outputs)
# ‚Ä¢ HAProxy: Access via HAProxy public IP (shown in outputs)
# ‚Ä¢ NGINX:   Access via NGINX public IPs (shown in outputs)
#
# Load balancer endpoints will provide access to:
# ‚Ä¢ UI Access:       Port 8443 (or frontend_ui_port for NGINX)
# ‚Ä¢ API Access:      Port 9443 (or frontend_api_port for NGINX)
# ‚Ä¢ Database Access: Port 12000+ (or database_port_range for NGINX)
#
#==============================================================================
# üîí SECURITY REMINDERS
#==============================================================================
#
# ‚úÖ DO:
# ‚Ä¢ Use strong, unique passwords
# ‚Ä¢ Store SSH keys securely
# ‚Ä¢ Restrict SSH access to your IP
# ‚Ä¢ Never commit terraform.tfvars to git
#
# ‚ö†Ô∏è  PRODUCTION:
# ‚Ä¢ Use AWS Systems Manager for secrets
# ‚Ä¢ Enable additional monitoring
# ‚Ä¢ Configure backup strategies
# ‚Ä¢ Review security group rules
# ‚Ä¢ Consider private subnets for nodes
# ‚Ä¢ Configure SSL/TLS termination on load balancers
#
#==============================================================================